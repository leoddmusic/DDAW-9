{% extends "base.html" %}
{% block title %}Productos (MySQL){% endblock %}

{% block content %}
<div class="toolbar">
  <h1>Productos (MySQL)</h1>
  <a class="btn primary" href="{{ url_for('mysql_productos_crear') }}">Crear producto (MySQL)</a>
</div>

{% if productos %}
<table class="table">
  <thead>
    <tr>
      <th>ID</th><th>Nombre</th><th>Precio</th><th>Stock</th><th>Acciones</th>
    </tr>
  </thead>
  <tbody>
  {% for p in productos %}
    <tr>
      <td>{{ p.id_producto }}</td>
      <td>{{ p.nombre }}</td>
      <td>${{ '%.2f'|format(p.precio) }}</td>
      <td>{{ p.stock }}</td>
      <td class="actions">
        <!-- OJO: el endpoint espera pid -->
        <a class="btn" href="{{ url_for('mysql_productos_editar', pid=p.id_producto) }}">Editar</a>
        <form action="{{ url_for('mysql_productos_eliminar', pid=p.id_producto) }}" method="post" style="display:inline">
          {{ csrf_token() if csrf_token is defined }}
          <button class="btn danger" type="submit" onclick="return confirm('¿Eliminar producto #{{p.id_producto}}?')">Eliminar</button>
        </form>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<div class="pagination">
  {% if prev_url %}<a class="btn" href="{{ prev_url }}">&laquo; Anterior</a>{% endif %}
  <span>Página {{ page }} / {{ total_pages }}</span>
  {% if next_url %}<a class="btn" href="{{ next_url }}">Siguiente &raquo;</a>{% endif %}
</div>
{% else %}
  <p>No hay productos.</p>
{% endif %}
{% endblock %}
